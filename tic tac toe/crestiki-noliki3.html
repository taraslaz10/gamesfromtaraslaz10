<!doctype html>
<html>
<head>
<title>rectExample</title>
<meta charset='utf-8' />
</head>
<body>
<canvas id='example'>Обновите браузер</canvas>
<script>
    var example = document.getElementById("example"),
    ctx = example.getContext('2d');
    
    example.width = 300;
    example.height = 300;
    
    for (i=0; i<300;i+=100){
        for(j=0;j<300;j+=100){
            ctx.strokeRect(i, j, 100, 100);
        }
    }
    
    var array = [0,0,0,0,0,0,0,0,0];
    
    
    var chod2=0;
    
    var chod1=0;
    var ult=0;
    var one = true, two = true, three = true , four = true, five = true, six = true, seven = true, eight = true, nine = true;
    var player = true, comp = false;
    
    var chod;
    example.addEventListener('mouseup', function (e) {
    
    var x = e.pageX - e.target.offsetLeft,
        y = e.pageY - e.target.offsetTop;
        
    //if(player==true){
    var random;
        
    ult++;
    
        
    pic = new Image();
    pic.src = "нолик.png";
    
    img = new Image();
    img.src = "хрестик.png";
    
    
    function chrest(x,y){
    img.onload = function(){
    ctx.drawImage(img,x+1,y+1);}}
        
    /*function nol(x){
    if(x==1){x=0;y=0;one=false;}
    else if(x==2){x=100;y=0;two=false;}
    else if(x==3){x=200;y=0;three=false;}
    else if(x==4){x=0;y=100;four=false;}
    else if(x==5){x=100;y=100;five=false;}
    else if(x==6){x=200;y=100;six=false;}
    else if(x==7){x=0;y=200;seven=false;}
    else if(x==8){x=100;y=200;eight=false;}
    else if(x==9){x=200;y=200;nine=false;}
    pic.onload = function() {
    ctx.drawImage(pic, x+1, y+1);}}*/
        
    function nol(x,y){    
    pic.onload = function() {
    ctx.drawImage(pic, x+1, y+1);}}
                             
                             
    if(x<100 && y<100 && one){
    one = false;  
    chrest(0,0);
    array[0] = 1;
    win();
    if(ult<5){
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<200 && y<100 && two && x>100 && y>0){
    two=false;
        
    chrest(100,0);
    array[1] = 1;
    win();
    if(ult<5){
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<300 && y<100 && three && x>200 && y>0){
    three=false;
        
    chrest(200,0);
            
    array[2] = 1;
    win();
    if(ult<5){    
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<100 && y<200 && four && x>0 && y>100){
    four=false;
        
    array[3] = 1;    
    chrest(0,100);
    win();
    if(ult<5){
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<200 && y<200 && five && x>100 && y>100){
    five=false;
    chod=0;    
    array[4] = 1;    
    
    chrest(100,100);
    win();
    if(ult<5){    
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<300 && y<200 && six && x>200 && y>100){
    six=false;
        
    array[5] = 1;    
    
    chrest(200,100);
    win();
    if(ult<5){
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<100 && y<300 && seven && x>0 && y>200){
    seven=false;
        
    array[6] = 1;    
    
    chrest(0,200);
    win();
    if(ult<5){
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<200 && y<300 && eight && x>100 && y>200){
    eight=false;
        
    array[7] = 1;    
    
    
    chrest(100,200);
    win();
    if(ult<5){
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    else if(x<300 && y<300 && nine && x>200 && y>200){
    nine=false;
        
    chrest(200,200);
    
    
    array[8] = 1;
    win();
    if(ult<5){    
    random = random(one,two,three,four,five,six,seven,eight,nine);
    nol(random);
    win();}
    }
    
    
    
        
    
    function random(one,two,three,four,five,six,seven,eight,nine){
    if(five==false && chod1==0){x=1;}
    else if(five){x=5;}
    else if(array[0]+array[1]+array[2]==-2 || array[0]+array[1]+array[2]==2){
    if(array[0]==0){x=1;}
    if(array[1]==0){x=2;}
    if(array[2]==0){x=3;}}
    else if(array[3]+array[4]+array[5]==-2 || array[3]+array[4]+array[5]==2){
    if(array[3]==0){x=4;}
    if(array[4]==0){x=5;}
    if(array[5]==0){x=6;}}
    else if(array[6]+array[7]+array[8]==-2 || array[6]+array[7]+array[8]==2){
    if(array[6]==0){x=7;}
    if(array[7]==0){x=8;}
    if(array[8]==0){x=9;}}
    else if(array[0]+array[3]+array[6]==-2 || array[0]+array[3]+array[6]==2){
    if(array[0]==0){x=1;}
    if(array[3]==0){x=4;}
    if(array[6]==0){x=7;}}
    else if(array[1]+array[4]+array[7]==-2 || array[1]+array[4]+array[7]==2){
    if(array[1]==0){x=2;}
    if(array[4]==0){x=5;}
    if(array[7]==0){x=8;}}
    else if(array[2]+array[5]+array[8]==-2 || array[2]+array[5]+array[8]==2){
    if(array[2]==0){x=3;}
    if(array[5]==0){x=6;}
    if(array[8]==0){x=9;}}
    else if(array[0]+array[4]+array[8]==-2 || array[0]+array[4]+array[8]==2){
    if(array[0]==0){x=1;}
    if(array[4]==0){x=5;}
    if(array[8]==0){x=9;}}
    else if(array[2]+array[4]+array[6]==-2 || array[2]+array[4]+array[6]==2){
    if(array[2]==0){x=3;}
    if(array[4]==0){x=5;}
    if(array[6]==0){x=7;}}
    else if(chod==1){
    x=5;
    chod=0;
    }
    else {
    if(one==false && chod1==1 && five==false && two){x=2;persiy=false;}
    else if(three==false && chod1==1 && five==false && two){x=2;persiy=false;}
    else if(seven==false && chod1==1 && five==false && two){x=2;persiy=false;}
    else if(nine==false && chod1==1 && five==false && two){x=2;persiy=false;}
    //else if(four){x=4;}
    else{
    while(true){
    var x = Math.random();
    if(x>=0 && x <= 0.11 && one){ x=1;break;}
    if (x > 0.11 && x <= 0.22 && two){ x=2;break;}
    if (x > 0.22 && x <= 0.33 && three){ x=3;break;}
    if (x > 0.33 && x <= 0.44 && four){ x=4;break;}
    if (x > 0.44 && x <= 0.55 && five){ x=5;break;}
    if (x > 0.55 && x <= 0.66 && six){ x=6;break;}
    if (x > 0.66 && x <= 0.77 && seven){ x=7;break;}
    if (x > 0.77 && x <= 0.88 && eight){ x=8;break;}
    if (x > 0.88 && x <= 1 && nine){ x=9;break;}
       }}}
    chod1+=1;
    return x;}
        
    function nol(x){
    if(x==1){x=0;y=0;one=false;array[0]=-1;}
    else if(x==2){x=100;y=0;two=false;array[1]=-1;}
    else if(x==3){x=200;y=0;three=false;array[2]=-1;}
    else if(x==4){x=0;y=100;four=false;array[3]=-1;}
    else if(x==5){x=100;y=100;five=false;array[4]=-1;}
    else if(x==6){x=200;y=100;six=false;array[5]=-1;}
    else if(x==7){x=0;y=200;seven=false;array[6]=-1;}
    else if(x==8){x=100;y=200;eight=false;array[7]=-1;}
    else if(x==9){x=200;y=200;nine=false;array[8]=-1;}
    pic.onload = function() {
    ctx.drawImage(pic, x+1, y+1);}}    
    //player=false;
    
    function win(){
    if(array[0]==1 && array[1]==1 && array[2]==1){
    alert("You win");
    ult=5;
    }
    else if(array[3]==1 && array[4]==1 && array[5]==1){
    alert("You win");
    ult=5;
    }
    else if(array[6]==1 && array[7]==1 && array[8]==1){
    alert("You win");
    ult=5;
    }
    else if(array[0]==1 && array[3]==1 && array[6]==1){
    alert("You win");
    ult=5;
    }
    else if(array[1]==1 && array[4]==1 && array[7]==1){
    alert("You win");
    ult=5;
    }
    else if(array[2]==1 && array[5]==1 && array[8]==1){
    alert("You win");
    ult=5;
    }
    else if(array[0]==1 && array[4]==1 && array[8]==1){
    alert("You win");
    ult=5;
    }
    else if(array[2]==1 && array[4]==1 && array[6]==1){
    alert("You win");
    ult=5;
    }
        
    else if(array[0]==-1 && array[1]==-1 && array[2]==-1){
    alert("You lose");
    }
    else if(array[3]==-1 && array[4]==-1 && array[5]==-1){
    alert("You lose");
    }
    else if(array[6]==-1 && array[7]==-1 && array[8]==-1){
    alert("You lose");
    }
    else if(array[0]==-1 && array[3]==-1 && array[6]==-1){
    alert("You lose");
    }
    else if(array[1]==-1 && array[4]==-1 && array[7]==-1){
    alert("You lose");
    }
    else if(array[2]==-1 && array[5]==-1 && array[8]==-1){
    alert("You lose");        
    }
    else if(array[0]==-1 && array[4]==-1 && array[8]==-1){
    alert("You lose");
    }
    else if(array[2]==-1 && array[4]==-1 && array[6]==-1){
    alert("You lose");}
    else if((array[0]==-1 || array[0]==1) && (array[1]==-1 || array[1]==1) && (array[2]==-1 || array[2]==1) &&  (array[3]==-1 || array[3]==1) && (array[4]==-1 || array[4]==1) && (array[5]==-1 || array[5]==1) && (array[6]==-1 || array[6]==1) && (array[7]==-1 || array[7]==1) && (array[8]==-1 || array[8]==1) ){
    alert("Nobody wins");        
    }
    }
    
    //else if(player==false){
        
    //pic = new Image();
    //pic.src = "нолик.png";
        
    //pic.onload = function() {
    //ctx.drawImage(pic, 101, 101);}
    
        
    
    //alert(randomly);
    /*
    function b(){
    var r = random(one,two,three,four,five,six,seven,eight,nine);
    alert(r);}
    
        
    */
    //player=true;    
    //}
        
        
        
    },false);
    
</script>
    
</body>
</html>